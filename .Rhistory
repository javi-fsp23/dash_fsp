radius = 20, group="Heatmap", blur = 20)
icons<-function(icono, color_m ,color){
makeAwesomeIcon(icon= icono,
markerColor=color_m,
library = "fa",
iconColor  = "white")}
leaflet() %>%setView( -99.1, 19.37, 10.5 ) %>% addTiles() %>%
#addPolygons(data = mx, weight = 2, fillOpacity = 0, color = 'blue', label = ~Municipios) %>%
addAwesomeMarkers(data = as,
lat = ~lat,
lng = ~long,
icon = awesomeIconList(icons(as$icon, as$Color, as$Color)),
group = ~Incidente, clusterOptions = markerClusterOptions(iconCreateFunction =JS(graf_mapa(as))),
popup = paste(paste0("<b>","Unidad ", as$unidad, "(", as$nombre_fcia,")", "</b>:", paste0(as$Incidente," (", as$Folio, ")<br>")),
"<b>", "Sub-incidente: ","</b>", as$Subincidente, "<br>",
"<b>", "Fecha: ","</b>", as$Recepcion, "<br>",
"<b>", "Gerente de farmacia: ","</b>", as$ger_fcia, "<br>",
"<b>", "Tel. Gerente de farmacia: ","</b>", paste0("<a href=tel:+", as$tel_ger_fcia,">", as$tel_ger_fcia, "</a>"), "<br>",
"<b>", "Gerente de zona: ","</b>", as$ger_zona, "<br>",
"<b>", "Tel. Gerente de zona: ","</b>", paste0("<a href=tel:+", as$tel_ger_zona,">", as$tel_ger_zona, "</a>"), "<br>",
"<b>", "Tel. consultorio: ","</b>", paste0("<a href=tel:+", as$cel_consul,">", as$cel_consul, "</a>"), "<br>",
"<b>", "Ger. siniestro consultorio: ","</b>", as$ger_siniestro_consul, "<br>",
"<b>", "Tel. Ger. siniestro consultorio: ","</b>", paste0("<a href=tel:+", as$tel_ger_consul,">", as$tel_ger_consul, "</a>"), "<br>")) %>%
addLayersControl( baseGroups = c("Carto", "World Imagen", "Dark Matter", "Street Map"),
overlayGroups = c("Heatmap") ,
options = layersControlOptions(collapsed = T),
position = 'bottomleft') %>% hideGroup( c("Heatmap"))  %>%
addLegend(title = "Prioridad: ", position = c("topright"), colors =  c("green", "orange", "red"),
labels = c("Baja", "Media", "Alta")) %>%
addProviderTiles("CartoDB.DarkMatter", group = "Dark Matter") %>%
addProviderTiles("CartoDB.Positron", group = "Carto") %>%
addProviderTiles("OpenStreetMap", group = "Street Map") %>%
addProviderTiles("Esri.WorldImagery",  group = "World Imagen") %>%
addHeatmap(lng = as$long, lat = as$lat, max = .05,
radius = 20, group="Heatmap", blur = 20)
View(as)
View(as)
mx
leaflet() %>%setView( -99.1, 19.37, 10.5 ) %>% addTiles() %>%
addPolygons(data = mx, weight = 2, fillOpacity = 0, color = 'blue', label = ~Municipios)
load("Z:/apps/shapes/edos.RData")
leaflet() %>%setView( -99.1, 19.37, 10.5 ) %>% addTiles() %>%
addPolygons(data = mx, weight = 2, fillOpacity = 0, color = 'blue',  label = ~nom_ent )
leaflet() %>%setView( -99.1, 19.37, 10.5 ) %>% addTiles() %>%
addPolygons(data = mx, weight = 2, fillOpacity = 0, color = 'blue',  label = ~nom_ent ) %>%
addAwesomeMarkers(data = as,
lat = ~lat,
lng = ~long,
icon = awesomeIconList(icons(as$icon, as$Color, as$Color)),
group = ~Incidente, clusterOptions = markerClusterOptions(iconCreateFunction =JS(graf_mapa(as))),
popup = paste(paste0("<b>","Unidad ", as$unidad, "(", as$nombre_fcia,")", "</b>:", paste0(as$Incidente," (", as$Folio, ")<br>")),
"<b>", "Sub-incidente: ","</b>", as$Subincidente, "<br>",
"<b>", "Fecha: ","</b>", as$Recepcion, "<br>",
"<b>", "Gerente de farmacia: ","</b>", as$ger_fcia, "<br>",
"<b>", "Tel. Gerente de farmacia: ","</b>", paste0("<a href=tel:+", as$tel_ger_fcia,">", as$tel_ger_fcia, "</a>"), "<br>",
"<b>", "Gerente de zona: ","</b>", as$ger_zona, "<br>",
"<b>", "Tel. Gerente de zona: ","</b>", paste0("<a href=tel:+", as$tel_ger_zona,">", as$tel_ger_zona, "</a>"), "<br>",
"<b>", "Tel. consultorio: ","</b>", paste0("<a href=tel:+", as$cel_consul,">", as$cel_consul, "</a>"), "<br>",
"<b>", "Ger. siniestro consultorio: ","</b>", as$ger_siniestro_consul, "<br>",
"<b>", "Tel. Ger. siniestro consultorio: ","</b>", paste0("<a href=tel:+", as$tel_ger_consul,">", as$tel_ger_consul, "</a>"), "<br>")) %>%
addLayersControl( baseGroups = c("Street Map", "Carto", "World Imagen", "Dark Matter"),
overlayGroups = c("Heatmap") ,
options = layersControlOptions(collapsed = T),
position = 'bottomleft') %>% hideGroup( c("Heatmap"))  %>%
addLegend(title = "Prioridad: ", position = c("topright"), colors =  c("green", "orange", "red"),
labels = c("Baja", "Media", "Alta")) %>%
addProviderTiles("OpenStreetMap", group = "Street Map") %>%
addProviderTiles("CartoDB.DarkMatter", group = "Dark Matter") %>%
addProviderTiles("CartoDB.Positron", group = "Carto") %>%
addProviderTiles("Esri.WorldImagery",  group = "World Imagen") %>%
addHeatmap(lng = as$long, lat = as$lat, max = .05,
radius = 20, group="Heatmap", blur = 20)
View(as)
icons<-function(icono, color_m ,color){
makeAwesomeIcon(icon= icono,
markerColor=color_m,
library = "fa",
iconColor  = color)}
icons(as$icon, as$Color, as$Color)
leaflet() %>%setView( -99.1, 19.37, 10.5 ) %>% addTiles() %>%
#addPolygons(data = mx, weight = 2, fillOpacity = 0, color = 'blue',  label = ~nom_ent ) %>%
addAwesomeMarkers(data = as,
lat = ~lat,
